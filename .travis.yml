language: python
cache: pip
jobs:
  include:
  - stage: Style Checking
    python: '3.6'
    install:
    - pip install -r requirements.txt
    - pip install -r dev.requirements.txt
    - pip install black
    script: black setup.py tests/ tgcli/ -l 79
  - stage: Testing (Python 3.5)
    python: '3.5'
    install:
    - pip install -r requirements.txt
    - pip install -r dev.requirements.txt
    script: pytest
  - stage: Testing (Python 3.6)
    python: '3.6'
    install:
    - pip install -r requirements.txt
    - pip install -r dev.requirements.txt
    script: pytest
  - stage: Covering / Deploy
    python: '3.6'
    install:
    - pip install -r requirements.txt
    - pip install -r dev.requirements.txt
    script:
    - pytest --cov tgcli tests/
    - codecov
    deploy:
      provider: pypi
      user: erayerdin
      password:
        secure: CmlW+FnT7u5VPHujrQmBjlH9dsAqPExFu5rXmHEsuabRyYOVIXsfjGWaf85S3rf5rOk4RLeoKVJB3KMjhlFfk2MA+VjGR0vYsCxMJPLxom2M/ZyXkjA2aogx7GUHVALE9+jnTpoi8lhYuiiJE/ePxI9hdgaDDTc5aeVqdJzLGHQSrzupsiXcIpxmd3UtXY6QWz5by/NvazuK2nOeppjSOoChDSMx2KDFZ7lFyCPK1Zfp/lBh5I73kiWe/KkrvyrH/TZyZ1xok634tt339AaWJYuBiMtHvLUGy3sVf4aNjaTg4zepl5sWTSH/Vg+Lrb5kbEtDdQinEIQGKcU9Y+yKL+GkCRfppHJYowQ/byUo/ulVsvKkddIyE9it9LIM83UHfYVdrkUIQGnRX3jn/xXoQBUUuxBl18yyRRInjtL2TLZuGyGy+pMV22cdE+7OcliF8WgGfPKEUSS2VSaJpEfwJMf/qVf4r1H+sXuJUIG27o/JIgZaGTjICqs4Q0kCh3WKR3By6ADKBsQKF9Wt/BJD5dK5lDuCw1ArcLbbWETPcNETJe09dGHWvHDOIqFMidZB5SM4lctNrgtbUxPj/0cA6KCwv6DxmEnthS6hrJUmZoMa0Vg8h8ZG4iv5SEeh5JhYCPmAxqDU6HrUqd7NfcNfDSknEwuINzYm0byCYdKp4xc=
      on:
        tags: true
